{
  "version": "2.1.0",
  "description": "RWP v2.1 Interoperability Test Vectors",
  "note": "Both TypeScript and Python implementations MUST produce identical canonical strings and signatures",
  "canonical_format": "version.primary_tongue.signing_tongue.aad.payload.nonce.timestamp",
  "vectors": [
    {
      "test_id": "vector_001_basic",
      "description": "Single signature, no AAD",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru..SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "7mEY-53jeVhX6O80PgVucxhnTxdSTsPkgfmUcB59MyA"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_002_with_aad",
      "description": "Single signature, with AAD (nested objects, keys sorted)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "aad": {
          "action": "execute",
          "mode": "STRICT",
          "priority": 1,
          "metadata": {
            "user": "alice",
            "session": "abc123"
          }
        },
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru.{\"action\":\"execute\",\"metadata\":{\"session\":\"abc123\",\"user\":\"alice\"},\"mode\":\"STRICT\",\"priority\":1}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "tvctUKfhUu7La6MoXAB1WBsIYgMTnVrvUu4kKkMeY5Y"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_003_multi_sig",
      "description": "Multi-signature (3 tongues)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001",
          "UM": "test-key-001",
          "DR": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "aad": {
          "action": "execute",
          "mode": "SECRET"
        },
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_strings": {
        "RU": "2.1.ru.ru.{\"action\":\"execute\",\"mode\":\"SECRET\"}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
        "UM": "2.1.ru.um.{\"action\":\"execute\",\"mode\":\"SECRET\"}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
        "DR": "2.1.ru.dr.{\"action\":\"execute\",\"mode\":\"SECRET\"}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567"
      },
      "expected_sigs": {
        "RU": "8JwiX8G62VMowUdijec8aV2oFIDlLtwYC3ytM5gqFxw",
        "UM": "PvCDA-BwslXtqPtitk2U6sSFid2y9JdA-E6D7NZbxxI",
        "DR": "_eWcgb5_YjolkKqwIGjPqNAutBIdDI_RttH_MEzC3Cg"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_004_all_tongues",
      "description": "All 6 tongues (CRITICAL mode)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "KO",
        "kid": {
          "KO": "test-key-001",
          "AV": "test-key-001",
          "RU": "test-key-001",
          "CA": "test-key-001",
          "UM": "test-key-001",
          "DR": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "aad": {
          "action": "launch",
          "mode": "CRITICAL"
        },
        "payload": "Q3JpdGljYWxQYXlsb2Fk"
      },
      "expected_sigs": {
        "KO": "DLdIuTYsbQvhC2dy-CsYqhLeztN7xjbPxoW9ntA9G3g",
        "AV": "bEwKwLU7qO6mntZwMvGCk6x17GCnHsPdxyaMF3cVpA0",
        "RU": "cbeS4xdMYgl5XbRyFswEzLPh7jvZYE3-4RLHQj6pn1E",
        "CA": "LIHQ9GHeb7r7tVW6WSoB6Jl_YTeav-y5z8bEUIzxrMY",
        "UM": "Zh9THv4C0EsjmIOAqqxM8FP-ytnJBAtpTKZPyZFlMSw",
        "DR": "xKsU9Czbj9Beqnzmhe0egcEXNdpZ_JkrQkSp9JvzXYE"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_005_empty_payload",
      "description": "Empty payload (edge case)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "payload": ""
      },
      "expected_canonical_string": "2.1.ru.ru...AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "vgcBn1vRMPizahVPqvq9OttH-LS_OZYZiIzhTLbivtY"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_006_max_nonce",
      "description": "Maximum nonce size (128 bytes)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyAhIiMkJSYnKCkqKywtLi8wMTIzNDU2Nzg5Ojs8PT4_QEFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaW1xdXl9gYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXp7fH1-fw",
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru..SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyAhIiMkJSYnKCkqKywtLi8wMTIzNDU2Nzg5Ojs8PT4_QEFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaW1xdXl9gYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXp7fH1-fw.1737161234567",
      "expected_sigs": {
        "RU": "Swedj_FUViBq-kXXMBNiq-Vwca98dzENlwHF_4Pef3k"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_007_special_chars",
      "description": "AAD with special characters (escaping test)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "aad": {
          "message": "Hello \"World\"",
          "path": "C:\\Users\\test",
          "unicode": "こんにちは"
        },
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru.{\"message\":\"Hello \\\"World\\\"\",\"path\":\"C:\\\\Users\\\\test\",\"unicode\":\"こんにちは\"}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "3mEbAxszPivO1qMJQRSM11akjR-Gw10qnhAUdYGS2tU"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_008_numbers",
      "description": "AAD with numbers (canonicalization test)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "aad": {
          "integer": 42,
          "float": 3.14159,
          "negative": -100,
          "zero": 0
        },
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru.{\"float\":3.14159,\"integer\":42,\"negative\":-100,\"zero\":0}.SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "X1mKwKmz0jxHX_4pWuwUEmsb2p9Cmcn6lM7a8eONor4"
      },
      "expected_result": "ALLOW"
    },
    {
      "test_id": "vector_009_expired",
      "description": "Expired timestamp (should DENY)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1000000000000,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru..SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1000000000000",
      "expected_sigs": {
        "RU": "rJHrLXpFZTmUN24iZtv6tTvp_Si5QDkeJF5PNA7Ykkc"
      },
      "expected_result": "DENY",
      "expected_reason": "timestamp_expired"
    },
    {
      "test_id": "vector_010_replay",
      "description": "Duplicate nonce (should DENY on second attempt)",
      "master_key": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
      "envelope": {
        "ver": "2.1",
        "primary_tongue": "RU",
        "kid": {
          "RU": "test-key-001"
        },
        "ts": 1737161234567,
        "nonce": "AQIDBAUGBwgJCgsMDQ4PEA",
        "payload": "SGVsbG8gV29ybGQ"
      },
      "expected_canonical_string": "2.1.ru.ru..SGVsbG8gV29ybGQ.AQIDBAUGBwgJCgsMDQ4PEA.1737161234567",
      "expected_sigs": {
        "RU": "7mEY-53jeVhX6O80PgVucxhnTxdSTsPkgfmUcB59MyA"
      },
      "expected_result": "DENY",
      "expected_reason": "nonce_replay",
      "note": "First attempt should ALLOW, second attempt with same nonce should DENY"
    }
  ]
}
